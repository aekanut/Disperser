<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style/datastyle.css">
    <title>show history</title>

</head>

<body>
    <input type="button" value="Add ID Card" onclick="idCard()">
    <input type="button" value="Add Student Card" onclick="studentCard()"><br>
    <input type="button" value="logout" onclick="logout()">
    <div class="idCard"></div><br><br>
    <div class="studentCard"></div>

    <script src="/script/datascript.js"></script>
    <script>
        const logout = async () => {
            const result = await fetch('/api/logout', {
                method: 'POST'
            }).then((res) => res.json());

            if (result.status === 'ok') {
                localStorage.removeItem('token');
                location.replace('/')
            }

        }

        const idCard = () => {
            location.replace("/main/idcard")
        }

        const studentCard = () => {
            location.replace("/main/student")
        }

        fetch('/api/allidcard').
            then(res => res.json()).
            then(data => {
                let dataTable = `<table><tr><th>Member ID</th><th>First Name</th><th>Last Name</th><th>ID Card</th><th>Date Of Birth</th><th>
Registration Date</th></tr>`
                data.forEach(element => {
                    dataTable += `<tr><th>${element._id}</th><th>${element.firstname}</th><th>${element.lastname}</th><th>${element.idcard}</th><th>${element.dateofbirth}</th><th>${element.Date}</th></tr>`
                });
                dataTable += '</table>'
                document.getElementsByClassName('idCard')[0].innerHTML = dataTable;
            })

        fetch('/api/allstudentcard').
            then(res => res.json()).
            then(data => {
                let dataTable = `<table><tr><th>Member ID</th><th>First Name</th><th>Last Name</th><th>Student ID</th><th>Faculty</th><th>
Registration Date</th></tr>`
                data.forEach(element => {
                    dataTable += `<tr><th>${element._id}</th><th>${element.firstname}</th><th>${element.lastname}</th><th>${element.studentcard}</th><th>${element.faculty}</th><th>${element.Date}</th></tr>`
                });
                dataTable += '</table>'
                document.getElementsByClassName('studentCard')[0].innerHTML = dataTable;
            })


    </script>
</body>

</html>